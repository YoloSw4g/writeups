#!/usr/bin/python

# Done using Sage (https://sagecell.sagemath.org/), cool for easy manipulations of big ints

badSig = "B132F77EFB2530131C4960842CE444949DD9E7870E74CF7E3E71E0E7601D444AFD10B3688288D7833551CD1A3C91878CA3F83918BFF4A5BDD449F5A96DB88622BD5A1E9C278071A8949FFAAD06D3F61D8C8306F63B852A5844F6FCC4C62B52C548D6BC5FF35B5448890C568085F86D469D3DD783609BBEAA7331A56D010A2363A1854534B78A0DEA9B2F20E9EECF0CC86367F173F1DE3D0293B027B24EAE8A35AC6822018860F92036D20A5AA6448B73DFE11D3421561CC341F9A21857437C7BCD7CA56B5022CD50067F36295DC04D3403AB7E82C469243E7ECC58896B00C114A1643A5CB66B4FC82FA195DD56C59E65C47E6493F13267131CFAD8D5E81562C412669C17BD4432706166C08AF759F6BE5EBBAC105CF94D823DBF6C5664215D462B6A399AAC18F217ABFD267F1EBBB0834A66F7731C72E8C2C9C78CDFB1DB515B8D883B1F0EADF9036EB0F95D21D2DCB207F7DDACB434FC038EE9810E917209F5347CB930278396F76F8784F2CD8C4A771CA91542DDB9FE9590FE1F92F746AA5DE79F511512CE3956E1FFA490F4F37897263022ED5B90096AEFBA6C97C531E1ED49A44582FC6C39C4102E3D47AC648F062A8CDBB6CF8E7BDA78A61EE2F1C872B43E1F687E2B08370A4DA1A17E1C8E55CB32D3B2B2A06BDCB6B651D7CDF614B9DF8C0F7AE8B6A8C3D754F379F3BDBBAEF41D3354C7DABE573733CE68256EDBB0A0"
N =      "CB28FE2B962BC4B4742B592EACFD0A1AD3A05E19C128090C260886BB63AB6E34571F2D2E013C5A8E875C59BB0A4A32EE020B0388ED7B003607062B087E2AA8FDE0DCCFB31C0F1B575F5A9FD13A038F0C48BF23E78673C72D11BE909A8BCB81715F87F882F250575856DCEC188146B7CA50213C444C5DF09179E431A5CC2B8BC405896D6FBB12484674E9C48C5E53501CE4491C7B562A5091DBD3B74A0FACED8151D40AC5899CFC1C89BF9AF318C3B937DE318CD8C7815059811A604019F3DED93B589ABE73F5C04FDD021F162C36454B3E56AB0562B85F4EDE3646DCD97A08D65D8551A7921C6AF1F81D6DDA3571DC5A7DFBA5C5E8849BBEE57ECED4B35EBA7199D5BB18CFC881F5DADA530251B9383148E3DAEED2D00A72285081D69782032BE521F4D29377412554BA6CBBA4B170D269EAC4EF2FC1713061EDB334C8049FE828D169FD92C72DDB010C2296D12D21D970C65C917E62C2766E5AF4FEC98EB82901221ED4EC136A35221F46CE9CCEA47AE4212381654B48F956860078B061129D81A0054D9F51937F12822BFD764F5C1DB82053336DABBB69270DAB47DAB92A9974D506296DD77292E4B54C7B2D60640D23AAEF8F1F96556F000D1E219FF33B9EC3715C03F56658FC7E5B57D9CB07A6DDDC1760EADAB1882DFBE1C84151DD5DB1668714245228C61E88647B5B54F4086B8F15971B190F86C14EFAF97747907EFD"
x =      "0001ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff005069632053616e73204e6f6d202833393133206d29"

#Convert to Sage integers
N =      ZZ('0x'+N)
badSig = ZZ('0x'+badSig)
x =      ZZ('0x'+ x)


#The magic happens here!
result = gcd(N, x-badSig^65537)

print "q = "+result
print "\n###\n"
print "p = "+N/result
